#todo: reduce repetitive code here